<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>회의록 상세 - AI 회의록 서비스</title>
  <link rel="stylesheet" href="static/css/style.css">
  <link rel="stylesheet" href="static/css/meetingDetail.css">
</head>

<body>
  <div class="container">

    <!-- Sidebar Trigger Zone -->
    <div class="sidebar-trigger"></div>

    <!-- Sidebar (fetch로 불러올 자리) -->
    <div id="sidebar-container"></div>

    <!-- Main Content -->
    <main class="main-content">
      <div class="content-wrapper">
        <!-- 헤더 -->
        <div class="detail-header">
          <button class="back-btn" onclick="goBack()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7" />
            </svg>
            뒤로가기
          </button>
          <div class="detail-actions">
            <button class="action-btn secondary" id="editToggleBtn" onclick="toggleEdit()">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" />
                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" />
              </svg>
              수정
            </button>
            <button class="action-btn primary" onclick="exportToPDF()">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                <polyline points="7 10 12 15 17 10" />
                <line x1="12" y1="15" x2="12" y2="3" />
              </svg>
              PDF 다운로드
            </button>
          </div>
        </div>

        <!-- 회의 정보 카드 -->
        <div class="meeting-info-card">
          <div class="meeting-info-header">
            <div>
              <h1 class="meeting-detail-title" id="meetingTitle">마케팅 전략 회의</h1>
              <div class="meeting-meta">
                <span class="meta-item">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                    <path d="M16 2v4M8 2v4M3 10h18" />
                  </svg>
                  2025년 9월 29일 14:00
                </span>
                <span class="meta-item">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10" />
                    <path d="M12 6v6l4 2" />
                  </svg>
                  45분
                </span>
                <span class="meta-item">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                    <circle cx="9" cy="7" r="4" />
                  </svg>
                  3명 참석
                </span>
              </div>
            </div>
            <select class="priority-select-large high" id="prioritySelect">
              <option value="high" selected>높음</option>
              <option value="medium">보통</option>
              <option value="low">낮음</option>
            </select>
          </div>
        </div>

        <!-- 주요 키워드 -->
        <div class="keywords-section">
          <h3 class="section-title">주요 키워드</h3>
          <div class="keywords-grid" id="keywordsGrid">
            <span class="keyword-chip">#마케팅</span>
            <span class="keyword-chip">#전략</span>
            <span class="keyword-chip">#Q4</span>
            <span class="keyword-chip">#목표</span>
            <span class="keyword-chip">#예산</span>
          </div>
        </div>

        <!-- 회의록 내용 -->
        <div class="meeting-content-section">
          <div class="section-header">
            <h3 class="section-title">회의록</h3>
            <div class="edit-notice hidden" id="editNotice">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10" />
                <path d="M12 16v-4M12 8h.01" />
              </svg>
              수정 모드
            </div>
          </div>

          <div class="content-card" id="contentCard">
            <div class="content-view" id="contentView">
              <h4>회의 목적</h4>
              <p>Q4 마케팅 전략 수립 및 예산 배분 논의</p>

              <h4>주요 안건</h4>
              <ol>
                <li>Q3 마케팅 성과 리뷰</li>
                <li>Q4 목표 및 전략 수립</li>
                <li>예산 배분 계획</li>
                <li>주요 캠페인 일정</li>
              </ol>

              <h4>논의 내용</h4>
              <p><strong>김명희:</strong> Q3 마케팅 캠페인의 ROI가 목표 대비 15% 상승했습니다. 특히 디지털 채널의 성과가 두드러졌습니다.</p>
              <p><strong>홍길동:</strong> 좋은 성과입니다. Q4에는 이 전략을 확대하되, 오프라인 채널도 균형있게 운영하면 좋겠습니다.</p>
              <p><strong>박지민:</strong> Q4 예산 중 60%를 디지털에, 40%를 오프라인에 배분하는 것을 제안합니다.</p>

              <h4>결정 사항</h4>
              <ul>
                <li>Q4 마케팅 예산: 5억원</li>
                <li>디지털 마케팅 60%, 오프라인 40% 배분</li>
                <li>주요 캠페인 10월 15일 시작</li>
              </ul>

              <h4>액션 아이템</h4>
              <ul>
                <li>김명희: 상세 예산안 작성 (10/5까지)</li>
                <li>박지민: 캠페인 기획서 제출 (10/8까지)</li>
                <li>홍길동: 경쟁사 분석 보고 (10/10까지)</li>
              </ul>
            </div>

            <textarea class="content-editor hidden" id="contentEditor"></textarea>
          </div>

          <div class="edit-actions hidden" id="editActions">
            <button class="action-btn secondary" onclick="cancelEdit()">취소</button>
            <button class="action-btn primary" onclick="saveEdit()">저장</button>
          </div>
        </div>

        <!-- 참석자 목록 -->
        <div class="participants-section">
          <h3 class="section-title">참석자</h3>
          <div class="participants-grid">
            <div class="participant-card">
              <div class="participant-avatar">홍</div>
              <div class="participant-info">
                <div class="participant-name">홍길동</div>
                <div class="participant-role">회의 주최자</div>
              </div>
            </div>
            <div class="participant-card">
              <div class="participant-avatar">김</div>
              <div class="participant-info">
                <div class="participant-name">김명희</div>
                <div class="participant-role">마케팅 팀장</div>
              </div>
            </div>
            <div class="participant-card">
              <div class="participant-avatar">박</div>
              <div class="participant-info">
                <div class="participant-name">박지민</div>
                <div class="participant-role">마케팅 매니저</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 챗봇 컨테이너 -->
      <div id="chatbot-container"></div>

      <!-- 플로팅 버튼 -->
      <button class="floating-chat-btn" id="floatingChatBtn">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
        </svg>
      </button>
    </main>
  </div>

  <script src="static/js/app.js"></script>
  <script src="static/js/meetingDetail.js"></script>
  <script>
    // 챗봇 로드
    fetch("components/chatbot.html")
      .then(res => res.text())
      .then(html => {
        const container = document.getElementById("chatbot-container");
        container.innerHTML = html;

        const closeBtn = container.querySelector(".close-chat-btn");
        const sendBtn = container.querySelector(".send-btn");
        const chatInput = container.querySelector("#chatInput");
        const floatingBtn = document.getElementById("floatingChatBtn");

        if (closeBtn) closeBtn.addEventListener("click", closeChat);
        if (sendBtn) sendBtn.addEventListener("click", sendMessage);
        if (chatInput) chatInput.addEventListener("keypress", handleChatEnter);
        if (floatingBtn) floatingBtn.addEventListener("click", openChat);
      });

    // 사이드바 로드
    fetch("components/sidebar.html")
      .then(res => res.text())
      .then(html => {
        const sidebar = document.getElementById("sidebar-container");
        sidebar.innerHTML = html;

        const currentPage = window.location.pathname.split("/").pop();
        const navItems = sidebar.querySelectorAll(".nav-menu a");

        navItems.forEach(item => {
          const linkPath = item.getAttribute("href");
          if (linkPath === currentPage) {
            item.classList.add("active");
          } else {
            item.classList.remove("active");
          }
        });
      });
  </script>
</body>

</html>